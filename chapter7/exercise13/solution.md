The client in Fig 5.5 spends most of its time blocked in the call to fgets, which in turn is blocked in some type of read operation on standard input within the standard I/O lib. When the keep-alive timer expires around two hourse after the last data exchange across the connection, and all the keep-alive probes fail to elicit a response from the server ,the socket's pending error is set to ETIMEDOUT. But the client is blocked in the call to fgets on stdin and will not see this error until it performs a read or write on the socket. This is one reason why we modified Fig 5.5 to use select in Chapter 6.
