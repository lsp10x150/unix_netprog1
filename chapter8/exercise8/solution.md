The largest IPv4 datagram is 65'535 bytes, limited by the 16-bit total length field in Fig A.1. The IP header requires 20 bytes and the UDP header requires 8 bytes, leaving a maximum of 65'507 bytes for user data. 
With IPv6 without jumbogram support, the size of the IPv6 header is 40 bytes, leaving a maximum of 65'487 bytes for user data.
Fig E.9 shows the new version of dg\_cli. If you forget to set the send buffer size, Berkley-derived kernels return an error of EMSGSIZE from sendto, since the size of the socket send buffer is normally less than required for a maximum-sized UDP datagram (be sure to do Eercise 7.1). But if we set the client's socket buffer sizes as shown in Fig E.9 and run the client program, nothing is returned by the server. We can verify that the client's datagram is sent to the server by tunning tcpdump, but if we put a printf in the server, its call to recvfrom does not return the datagram. The problem is that the server's UDP socket receivebuffer is smaller than the datagram we are sending, so the datagram is discarded and not delivered to the  socket. On a FreeBSD system, we can verify this by running netstat -s and looking at the "dropped due to full socket buffers" counter before and after our big datagram is received. The final solution is to modify the server, setting its socket send and receive buffer sizes.
